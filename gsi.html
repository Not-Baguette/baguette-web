<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width">
        <title>GSI Quick Support</title>
        <link rel="icon" type="image/png" href="https://em-content.zobj.net/source/twitter/71/baguette-bread_1f956.png">
        <!-- Bootstrap CSS Script and CSS rules -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
        <meta name="description" content="All you need to know about GSIs"/>
        <meta name="author" content="Baguette">
        <meta name="keywords" content="GSI bgN bgS bvN vndklite lite slim">
        <meta property="og:image" content="assets/">  <!-- logo pending -->
        <meta proprety="og:image:type" content="https://developer.android.com/static/topic/generic-system-image/images/gsi-support.png">
        <link rel="stylesheet" href="style.css">
        <style>
            /* Placed here so it doesn't fk up other pages */
            img {
                display: block;
                margin-left: auto;
                margin-right: auto;
                margin-top: 20px;
                margin-bottom: 20px;
            }
        </style>
</head>
<body>
    <!-- Navigation Bar, make it expanding -->
    <nav class="navbar py-4 navbar-custom navbar-expand-lg">
        <div class="container-fluid">
            <span class="navbar-brand mb-0 h1">Baguette</span>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
            </button>
        <!-- List of Navigations on a navigation bar-->
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link" href="gsi.html">Home</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="https://discord.com/invite/e4v8qtkcBw">Help</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#whatis">What is a GSI?</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#requirements">Requirements</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#install">Install a GSI</a>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#naming" id="navbarDropdown1" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        <span id="dropdownTitle1">GSI Naming Conventions</span>
                    </a>
                <ul class="dropdown-menu" aria-labelledby="navbarDropdown1">
                    <li><a class="dropdown-item" href="#n-arch">CPU Architecture (A/B)</a></li>
                    <li><a class="dropdown-item" href="#n-bgn">bgN/bgS/etc.</a></li>
                    <li><a class="dropdown-item" href="#n-system">vndklite/secure/personal</a></li>
                    <li><a class="dropdown-item" href="#n-slim">Slim/lite</a></li>
                </ul>
            </li>
            <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" href="#common-issues" id="navbarDropdown2" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                    <span id="dropdownTitle2">Common Issues</span>
                </a>
            <ul class="dropdown-menu" aria-labelledby="navbarDropdown2">
                <li><a class="dropdown-item" href="#no-such">No such partition</a></li>
                <li><a class="dropdown-item" href="#not-enough">Not enough space</a></li>
            </ul>
        </div>
    </div>
    </nav>

    <div class="container-fluid">
    <h2 id="whatis">What is a GSI?</h2>
    <p>A generic system image (GSI) is a system image that is runnable on a variety of Android devices. Different 
        than custom ROM builds which are only runnable on a few specific devices, GSIs can run on <i>most</i> devices that 
        supports treble. You can check this via <a href=https://play.google.com/store/apps/details?id=tk.hack5.treblecheck>This app</a>.</p>
    
    <h2 id="requirements">What are the requirements?</h2>
    <li>[Both] A device that supports treble. Check via <a href=https://play.google.com/store/apps/details?id=tk.hack5.treblecheck>this app</a>.</li>
    <li>[Both] Unlocked bootloader</li>
    <li>[Both] A GSI (find one that is the same or higher than your current SDK)
        find it <a href="https://github.com/phhusson/treble_experimentations/wiki/Generic-System-Image-%28GSI%29-list">here.</a></li>
    <li>[DSU method] Dynamic Partitions: Enabled (Check via <a href=https://play.google.com/store/apps/details?id=tk.hack5.treblecheck>this app</a>.)</li>
    <li>[Both] A little faith in yourself</li>
    <p></p> <!-- Lazy fix -->

    <div class="alert alert-warning">
        <strong>Warning!</strong> We don't recommend using GSI because of various side effects faced 
        on most devices, such as instability, performance, battery and feature issues. Proceed at your 
        own risk.
    </div>

    <h2 id="naming">Naming conventions and which one to pick</h2>
    <img src="assets/gsi/crdroid-a13-gsis.png" alt="GSI examples"></img>
    <p>You can usually check what features are working on your phone and what doesn't by going to
        <a href="https://github.com/phhusson/treble_experimentations/wiki">This site</a> and then locate your phone</p>
    <p>This is barely talked about lately as some people assume everyone knew the meaning. Other GSIs might 
        have different naming conventions so this is a very broad conventions. These are simply ones I know of;</p>
    <ol type="1">
        <li><h3 id="n-arch">arm/a64/arm64</h3>
            <ul>
                <p>You can find this under 'CPU Architecture' on Treble info app.</p>
                <li>arm: arm 32-bit, you won't find this often unless you're searching for android 12 or lower.</li>
                <li>a64: arm 32-bit with 64-bit binder, check 'Binder Architecture' for <b>64-bit</b> while having 32-bit CPU architecture.</li>
                <li>arm64: ARM 64-bit, the most common as of date.</li>
            </ul>
        </li>
        <li><h3 id="n-bgn">bgN/bgS/etc.</h3></li>
        <!-- BGN rant List for naming conventions -->
        <ul style="list-style-type:square">
            <!-- What the fuck is this shitfuckery of a nested fuck -->
            <p>This part will be separated into three parts, as their characters do [a/b][v/g/f/o][N/S]</p>
            <li><ul style="list-style-type:disc"><h4>[a/b]</h4>
                <p>refers to Android feature to have two sets of android system, one for each slot. 
                    This usually used for seamless Updates and fallbacks. Check this via 'System-as-root' 
                    and 'Seamless Updates' on Treble info. (If enabled - ab. if not, a)</p>
                <li>a: A-only system, If you have an A-only system, then you need to flash the GSI 
                    directly as system as DSU method wont be possible</li>
                <li>b: A/B, The GSI is meant to be flashed on an A/B phone. Common nowdays.</li>
                </ul></li>
            
            <li><ul style="list-style-type:disc"><h4>[v/g/f/o]</h4>
                <p>refers to the google apps condition.</p>
                <li>v: Vanilla, no google apps</li>
                <li>g: Google, with google apps</li>
                <li>f: FOSS, Free Open Source Softwares alongside Microg usually</li>
                <li>o: Android Go Google Apps built in</li>
                </ul></li>

            <li><ul style="list-style-type:disc"><h4>[N/S]</h4>
                <p>refers to the Superuser state</p>
                <li>N: Normal/No, No Superuser (You can still manually patch it via magisk or such)</li>
                <li>S: Superuser built-in, you'll need <a href="https://f-droid.org/en/packages/me.phh.superuser/">this app</a>.</li>
            </ul></li>
        
        <li><ul style="list-style-type:disc"><h3 id="n-system">[vndklite/secure/personal]</h3>
            <li>vndklite: Use this for vndklite devices, check via treble info. This makes system partition read-writeable (rw rather than RO)</li>
            <li>Secure: Superuser removed and build.prop is spoofed to pass safetynet and Play Integrity</li>
            <li>Personal: Personal modifications, you probably wont need this</li>
        </ul></li>

    <li><ul style="list-style-type:disc"><h3 id="n-slim">slim/lite/core</h3>
        <li>both usually refers to a version of the gsi with less stuff in it, resulting in smaller size albeit 
            with less features sometimes</li>
        </ul></li>
    </ul>

    <!-- Installation guide -->
    <h2 id="install">How to Install a GSI?</h2>
    <h3>DSU Method</h3>
    <p>It depends heavily on your phone. I <i>personally</i> recommend to install it via Vegabobo's 
        <a href=https://github.com/VegaBobo/DSU-Sideloader/releases/>DSU sideloader</a>. This is 
        because if the GSI fails to boot up, it will fall back to your original OS without losing any data 
        (Considering your bootloader is unlocked beforehand). However there's a huge limit on storage size 
        (More than 50% of your storage might be unavailable). <b>Just remember to unlock your bootloader else
        you might hardbrick it.</b></p>

    <h3>Direct Method</h3>
    <p>While I recommend against this, (The success rate is probably around 40%). This is very much possible.
        <b>Continue at your own risk.</b> Make sure to backup your data before doing this. Only use 
        this tutorial if your device is not in XDA forums or <a href="https://github.com/phhusson/treble_experimentations/wiki">here.</a></p>
        <ol>What we basically will do:
        <li>Flash the GSI as system image via fastboot/recovery</li>
        <li>Patch vbmeta </li>
        <li>Switch to a permissive SELinux (Unneeded usually, only try if you know what you're doing)</li>
    </ol>
    
    <h4>Devices with fastboot:</h4>
        <ol>
            <li>Go to your bootloader (fastboot) via <code>adb reboot bootloader</code> or vol- & power combo</li>
            <li>Flash the GSI (Unzip it until you get a .img file) as system image via <code>fastboot flash system C:/path/to/gsi</code> (Do NOT flash it to super partition)</li>
            <li>Flash vbmeta (Make sure it's the same build or it'll brick) via <code>fastboot flash vbmeta C:/path/to/vbmeta --disable-verity --disable-verification</code></li>
            <li>erase userdata via <code>fastboot erase userdata</code></li>
            <li>Try booting up, if it still does not boot up, try other GSIs. If none works, try disabling selinux by patching boot.img</li>
        </ol>
    <h4>Samsung:</h4>
        <ol>
            <li>Go to download mode</li>
            <li>Flash a custom recovery onto your device alongside vbmeta-disabler (important for both the gsi and )</li>
            <li>Reboot to custom recovery</li>
            <li>Go to install menu and then select the GSI</li>
            <li>Wipe Data, Dalvik, and cache</li>
            <li>Try booting up.</li>
        </ol>

    <h3 id="#common-issues">Common Issues</h3>
    <ol>
        <li id="no-such">'(system) No such partition'</li>
        <p>Try going to fastbootd via <code>fastboot reboot fastboot</code> and try flashing it there</p>

        <li id="not-enough">'Not enough space to resize partition'</li>
        <p>Your gsi image is too big, find a lighter GSI. You can also resize your system partition via
            fastbootd (<code>fastboot reboot fastboot</code>) and then resizing it. This depends on the 
            device itself but usually system_ext/product is the best to minimize/erase to make room.</p>
        <code>fastboot delete-logical-partition product_a</code>
        <p>Or/and</p>
        <code>fastboot delete-logical-partition system_ext_a</code>

        <p>Or you can resize it</p>
        <code>fastboot create-logical-partition system_ext_a 33500</code>
        <p></p> <!-- lazy fix -->
        <code>fastboot create-logical-partition product_a 33500</code>
        <p>Now try reflashing it</p>
    </ol>

    <div class="alert alert-info">
        <strong>Info:</strong> Thank you to all my friends in XDA discord server for helping me learn this far!
    </div>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
    <script>
    $(document).ready(function () {
        

        for (let i = 1; i <= 3; i++) {
            $('#navbarDropdown' + i).on('show.bs.dropdown', function () {
                $('#dropdownTitle' + i).css('color', '#FF0000');
            });

            $('#navbarDropdown' + i).on('hide.bs.dropdown', function () {
                $('#dropdownTitle' + i).css('color', '');
            });
        }

        // Initially hide both content divs
        document.getElementById('contentnew').style.display = 'none';
        document.getElementById('contentold').style.display = 'none';
        
        document.getElementById('managernew').addEventListener('click', function() {
            // Show contentnew and hide contentold
            document.getElementById('contentnew').style.display = 'block';
            document.getElementById('contentold').style.display = 'none';
        });

        document.getElementById('managerold').addEventListener('click', function() {
            document.getElementById('contentnew').style.display = 'none';
            document.getElementById('contentold').style.display = 'block';
        });
    });
    </script>  
</body>
</html>
